{"ast":null,"code":"/**\r\n * DevExtreme (ui/toolbar/ui.toolbar.strategy.js)\r\n * Version: 19.2.2\r\n * Build date: Tue Oct 01 2019\r\n *\r\n * Copyright (c) 2012 - 2019 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\"),\n  noop = require(\"../../core/utils/common\").noop,\n  each = require(\"../../core/utils/iterator\").each,\n  errors = require(\"../../core/errors\"),\n  compileGetter = require(\"../../core/utils/data\").compileGetter,\n  Class = require(\"../../core/class\"),\n  Button = require(\"../button\"),\n  abstract = Class.abstract;\nvar TOOLBAR_MENU_CONTAINER_CLASS = \"dx-toolbar-menu-container\",\n  TOOLBAR_MENU_BUTTON_CLASS = \"dx-toolbar-menu-button\";\nvar ToolbarStrategy = Class.inherit({\n  ctor: function ctor(toolbar) {\n    this._toolbar = toolbar;\n  },\n  render: function render() {\n    this._renderMenuButton();\n    this._renderWidget();\n  },\n  _widgetOptions: function _widgetOptions() {\n    var itemClickAction = this._toolbar._createActionByOption(\"onItemClick\");\n    return {\n      itemTemplate: this._getMenuItemTemplate.bind(this),\n      onItemClick: function (e) {\n        this._toggleMenu(false, true);\n        itemClickAction(e);\n      }.bind(this)\n    };\n  },\n  _getMenuItemTemplate: function _getMenuItemTemplate() {\n    return this._toolbar._getTemplateByOption(\"menuItemTemplate\");\n  },\n  _renderWidget: function _renderWidget() {\n    var $menu = $(\"<div>\").appendTo(this._menuContainer());\n    this._menu = this._toolbar._createComponent($menu, this._menuWidgetClass(), this._widgetOptions());\n    this.renderMenuItems();\n  },\n  _menuContainer: abstract,\n  _menuWidgetClass: abstract,\n  _hasVisibleMenuItems: function _hasVisibleMenuItems(items) {\n    var menuItems = items || this._toolbar.option(\"items\"),\n      result = false;\n    var optionGetter = compileGetter(\"visible\"),\n      overflowGetter = compileGetter(\"locateInMenu\");\n    var menuLocation = false;\n    each(menuItems, function (index, item) {\n      var itemVisible = optionGetter(item, {\n          functionsAsIs: true\n        }),\n        itemOverflow = overflowGetter(item, {\n          functionsAsIs: true\n        });\n      if (\"menu\" === item.location) {\n        menuLocation = true;\n      }\n      if (false !== itemVisible && (\"auto\" === itemOverflow || \"always\" === itemOverflow || \"menu\" === item.location)) {\n        result = true;\n      }\n    });\n    if (menuLocation) {\n      errors.log(\"W0001\", \"dxToolbar - 'location' item field\", \"menu\", \"16.1\", \"Use 'locateInMenu' item field instead.\");\n    }\n    return result;\n  },\n  _getMenuItems: function _getMenuItems() {\n    return this._toolbar._getMenuItems();\n  },\n  _updateMenuVisibility: noop,\n  _renderMenuButton: function _renderMenuButton() {\n    var buttonOptions = this._menuButtonOptions();\n    this._renderMenuButtonContainer();\n    this._$button = $(\"<div>\").appendTo(this._$menuButtonContainer).addClass(TOOLBAR_MENU_BUTTON_CLASS);\n    this._toolbar._createComponent(this._$button, Button, buttonOptions);\n  },\n  _menuButtonOptions: function _menuButtonOptions() {\n    return {\n      onClick: this._menuButtonClickHandler.bind(this)\n    };\n  },\n  _menuButtonClickHandler: function _menuButtonClickHandler() {\n    this._toggleMenu(!this._menuShown, true);\n  },\n  _renderMenuButtonContainer: function _renderMenuButtonContainer() {\n    var $afterSection = this._toolbar._$afterSection;\n    this._$menuButtonContainer = $(\"<div>\").appendTo($afterSection).addClass(this._toolbar._buttonClass()).addClass(TOOLBAR_MENU_CONTAINER_CLASS);\n  },\n  renderMenuItems: function renderMenuItems() {\n    this._menu && this._menu.option(\"items\", this._getMenuItems());\n  },\n  toggleMenuVisibility: function toggleMenuVisibility(visible, animate) {\n    this._menu && this._toggleMenu(visible, animate);\n  },\n  _toggleMenu: function _toggleMenu(visible) {\n    this._menuShown = visible;\n  },\n  getMenuWidget: function getMenuWidget() {\n    return this._menu;\n  },\n  widgetOption: function widgetOption(name, value) {\n    this._menu && this._menu.option(name, value);\n  },\n  handleToolbarVisibilityChange: noop\n});\nmodule.exports = ToolbarStrategy;","map":null,"metadata":{},"sourceType":"script"}