{"ast":null,"code":"/**\r\n * DevExtreme (ui/list/ui.list.base.js)\r\n * Version: 19.2.2\r\n * Build date: Tue Oct 01 2019\r\n *\r\n * Copyright (c) 2012 - 2019 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\"),\n  eventsEngine = require(\"../../events/core/events_engine\"),\n  commonUtils = require(\"../../core/utils/common\"),\n  typeUtils = require(\"../../core/utils/type\"),\n  iconUtils = require(\"../../core/utils/icon\"),\n  getPublicElement = require(\"../../core/utils/dom\").getPublicElement,\n  each = require(\"../../core/utils/iterator\").each,\n  compileGetter = require(\"../../core/utils/data\").compileGetter,\n  extend = require(\"../../core/utils/extend\").extend,\n  fx = require(\"../../animation/fx\"),\n  clickEvent = require(\"../../events/click\"),\n  swipeEvents = require(\"../../events/swipe\"),\n  support = require(\"../../core/utils/support\"),\n  messageLocalization = require(\"../../localization/message\"),\n  inkRipple = require(\"../widget/utils.ink_ripple\"),\n  devices = require(\"../../core/devices\"),\n  ListItem = require(\"./item\"),\n  Button = require(\"../button\"),\n  eventUtils = require(\"../../events/utils\"),\n  themes = require(\"../themes\"),\n  windowUtils = require(\"../../core/utils/window\"),\n  ScrollView = require(\"../scroll_view\"),\n  deviceDependentOptions = require(\"../scroll_view/ui.scrollable\").deviceDependentOptions,\n  CollectionWidget = require(\"../collection/ui.collection_widget.live_update\").default,\n  BindableTemplate = require(\"../../core/templates/bindable_template\").BindableTemplate,\n  Deferred = require(\"../../core/utils/deferred\").Deferred,\n  DataConverterMixin = require(\"../shared/grouped_data_converter_mixin\").default;\nvar LIST_CLASS = \"dx-list\",\n  LIST_ITEM_CLASS = \"dx-list-item\",\n  LIST_ITEM_SELECTOR = \".\" + LIST_ITEM_CLASS,\n  LIST_ITEM_ICON_CONTAINER_CLASS = \"dx-list-item-icon-container\",\n  LIST_ITEM_ICON_CLASS = \"dx-list-item-icon\",\n  LIST_GROUP_CLASS = \"dx-list-group\",\n  LIST_GROUP_HEADER_CLASS = \"dx-list-group-header\",\n  LIST_GROUP_BODY_CLASS = \"dx-list-group-body\",\n  LIST_COLLAPSIBLE_GROUPS_CLASS = \"dx-list-collapsible-groups\",\n  LIST_GROUP_COLLAPSED_CLASS = \"dx-list-group-collapsed\",\n  LIST_GROUP_HEADER_INDICATOR_CLASS = \"dx-list-group-header-indicator\",\n  LIST_HAS_NEXT_CLASS = \"dx-has-next\",\n  LIST_NEXT_BUTTON_CLASS = \"dx-list-next-button\",\n  WRAP_ITEM_TEXT_CLASS = \"dx-wrap-item-text\",\n  SELECT_ALL_ITEM_SELECTOR = \".dx-list-select-all\",\n  LIST_ITEM_DATA_KEY = \"dxListItemData\",\n  LIST_FEEDBACK_SHOW_TIMEOUT = 70;\nvar groupItemsGetter = compileGetter(\"items\");\nvar ListBase = CollectionWidget.inherit({\n  _activeStateUnit: [LIST_ITEM_SELECTOR, SELECT_ALL_ITEM_SELECTOR].join(\",\"),\n  _supportedKeys: function _supportedKeys() {\n    var that = this;\n    var moveFocusPerPage = function moveFocusPerPage(direction) {\n      var $item = getEdgeVisibleItem(direction),\n        isFocusedItem = $item.is(that.option(\"focusedElement\"));\n      if (isFocusedItem) {\n        scrollListTo($item, direction);\n        $item = getEdgeVisibleItem(direction);\n      }\n      that.option(\"focusedElement\", getPublicElement($item));\n      that.scrollToItem($item);\n    };\n    var getEdgeVisibleItem = function getEdgeVisibleItem(direction) {\n      var scrollTop = that.scrollTop(),\n        containerHeight = that.$element().height();\n      var $item = $(that.option(\"focusedElement\")),\n        isItemVisible = true;\n      if (!$item.length) {\n        return $();\n      }\n      while (isItemVisible) {\n        var $nextItem = $item[direction]();\n        if (!$nextItem.length) {\n          break;\n        }\n        var nextItemLocation = $nextItem.position().top + $nextItem.outerHeight() / 2;\n        isItemVisible = nextItemLocation < containerHeight + scrollTop && nextItemLocation > scrollTop;\n        if (isItemVisible) {\n          $item = $nextItem;\n        }\n      }\n      return $item;\n    };\n    var scrollListTo = function scrollListTo($item, direction) {\n      var resultPosition = $item.position().top;\n      if (\"prev\" === direction) {\n        resultPosition = $item.position().top - that.$element().height() + $item.outerHeight();\n      }\n      that.scrollTo(resultPosition);\n    };\n    return extend(this.callBase(), {\n      leftArrow: commonUtils.noop,\n      rightArrow: commonUtils.noop,\n      pageUp: function pageUp() {\n        moveFocusPerPage(\"prev\");\n        return false;\n      },\n      pageDown: function pageDown() {\n        moveFocusPerPage(\"next\");\n        return false;\n      }\n    });\n  },\n  _getDefaultOptions: function _getDefaultOptions() {\n    return extend(this.callBase(), {\n      hoverStateEnabled: true,\n      pullRefreshEnabled: false,\n      scrollingEnabled: true,\n      showScrollbar: \"onScroll\",\n      useNativeScrolling: true,\n      bounceEnabled: true,\n      scrollByContent: true,\n      scrollByThumb: false,\n      pullingDownText: messageLocalization.format(\"dxList-pullingDownText\"),\n      pulledDownText: messageLocalization.format(\"dxList-pulledDownText\"),\n      refreshingText: messageLocalization.format(\"dxList-refreshingText\"),\n      pageLoadingText: messageLocalization.format(\"dxList-pageLoadingText\"),\n      onScroll: null,\n      onPullRefresh: null,\n      onPageLoading: null,\n      pageLoadMode: \"scrollBottom\",\n      nextButtonText: messageLocalization.format(\"dxList-nextButtonText\"),\n      onItemSwipe: null,\n      grouped: false,\n      onGroupRendered: null,\n      collapsibleGroups: false,\n      groupTemplate: \"group\",\n      indicateLoading: true,\n      activeStateEnabled: true,\n      _itemAttributes: {\n        role: \"option\"\n      },\n      _listAttributes: {\n        role: \"listbox\"\n      },\n      useInkRipple: false,\n      wrapItemText: false,\n      showChevronExpr: function showChevronExpr(data) {\n        return data ? data.showChevron : void 0;\n      },\n      badgeExpr: function badgeExpr(data) {\n        return data ? data.badge : void 0;\n      }\n    });\n  },\n  _defaultOptionsRules: function _defaultOptionsRules() {\n    var themeName = themes.current();\n    return this.callBase().concat(deviceDependentOptions(), [{\n      device: function device() {\n        return !support.nativeScrolling;\n      },\n      options: {\n        useNativeScrolling: false\n      }\n    }, {\n      device: function device(_device) {\n        return !support.nativeScrolling && !devices.isSimulator() && \"desktop\" === devices.real().deviceType && \"generic\" === _device.platform;\n      },\n      options: {\n        showScrollbar: \"onHover\",\n        pageLoadMode: \"nextButton\"\n      }\n    }, {\n      device: function device() {\n        return \"desktop\" === devices.real().deviceType && !devices.isSimulator();\n      },\n      options: {\n        focusStateEnabled: true\n      }\n    }, {\n      device: function device() {\n        return themes.isMaterial(themeName);\n      },\n      options: {\n        pullingDownText: \"\",\n        pulledDownText: \"\",\n        refreshingText: \"\",\n        pageLoadingText: \"\",\n        useInkRipple: true\n      }\n    }]);\n  },\n  _visibilityChanged: function _visibilityChanged(visible) {\n    if (visible) {\n      this._updateLoadingState(true);\n    }\n  },\n  _itemClass: function _itemClass() {\n    return LIST_ITEM_CLASS;\n  },\n  _itemDataKey: function _itemDataKey() {\n    return LIST_ITEM_DATA_KEY;\n  },\n  _itemContainer: function _itemContainer() {\n    return this._$container;\n  },\n  _refreshItemElements: function _refreshItemElements() {\n    if (!this.option(\"grouped\")) {\n      this._itemElementsCache = this._itemContainer().children(this._itemSelector());\n    } else {\n      this._itemElementsCache = this._itemContainer().children(\".\" + LIST_GROUP_CLASS).children(\".\" + LIST_GROUP_BODY_CLASS).children(this._itemSelector());\n    }\n  },\n  reorderItem: function reorderItem(itemElement, toItemElement) {\n    var promise = this.callBase(itemElement, toItemElement);\n    return promise.done(function () {\n      this._refreshItemElements();\n    });\n  },\n  deleteItem: function deleteItem(itemElement) {\n    var promise = this.callBase(itemElement);\n    return promise.done(function () {\n      this._refreshItemElements();\n    });\n  },\n  _itemElements: function _itemElements() {\n    return this._itemElementsCache;\n  },\n  _itemSelectHandler: function _itemSelectHandler(e) {\n    if (\"single\" === this.option(\"selectionMode\") && this.isItemSelected(e.currentTarget)) {\n      return;\n    }\n    this.callBase(e);\n  },\n  _allowDynamicItemsAppend: function _allowDynamicItemsAppend() {\n    return true;\n  },\n  _init: function _init() {\n    this.callBase();\n    this._$container = this.$element();\n    this._initScrollView();\n    this._feedbackShowTimeout = LIST_FEEDBACK_SHOW_TIMEOUT;\n    this._createGroupRenderAction();\n  },\n  _scrollBottomMode: function _scrollBottomMode() {\n    return \"scrollBottom\" === this.option(\"pageLoadMode\");\n  },\n  _nextButtonMode: function _nextButtonMode() {\n    return \"nextButton\" === this.option(\"pageLoadMode\");\n  },\n  _dataSourceOptions: function _dataSourceOptions() {\n    var scrollBottom = this._scrollBottomMode(),\n      nextButton = this._nextButtonMode();\n    return extend(this.callBase(), {\n      paginate: commonUtils.ensureDefined(scrollBottom || nextButton, true)\n    });\n  },\n  _getGroupedOption: function _getGroupedOption() {\n    return this.option(\"grouped\");\n  },\n  _dataSourceFromUrlLoadMode: function _dataSourceFromUrlLoadMode() {\n    return \"raw\";\n  },\n  _initScrollView: function _initScrollView() {\n    var scrollingEnabled = this.option(\"scrollingEnabled\"),\n      pullRefreshEnabled = scrollingEnabled && this.option(\"pullRefreshEnabled\"),\n      autoPagingEnabled = scrollingEnabled && this._scrollBottomMode() && !!this._dataSource;\n    this._scrollView = this._createComponent(this.$element(), ScrollView, {\n      disabled: this.option(\"disabled\") || !scrollingEnabled,\n      onScroll: this._scrollHandler.bind(this),\n      onPullDown: pullRefreshEnabled ? this._pullDownHandler.bind(this) : null,\n      onReachBottom: autoPagingEnabled ? this._scrollBottomHandler.bind(this) : null,\n      showScrollbar: this.option(\"showScrollbar\"),\n      useNative: this.option(\"useNativeScrolling\"),\n      bounceEnabled: this.option(\"bounceEnabled\"),\n      scrollByContent: this.option(\"scrollByContent\"),\n      scrollByThumb: this.option(\"scrollByThumb\"),\n      pullingDownText: this.option(\"pullingDownText\"),\n      pulledDownText: this.option(\"pulledDownText\"),\n      refreshingText: this.option(\"refreshingText\"),\n      reachBottomText: this.option(\"pageLoadingText\"),\n      useKeyboard: false\n    });\n    this._$container = $(this._scrollView.content());\n    if (this.option(\"wrapItemText\")) {\n      this._$container.addClass(WRAP_ITEM_TEXT_CLASS);\n    }\n    this._createScrollViewActions();\n  },\n  _createScrollViewActions: function _createScrollViewActions() {\n    this._scrollAction = this._createActionByOption(\"onScroll\");\n    this._pullRefreshAction = this._createActionByOption(\"onPullRefresh\");\n    this._pageLoadingAction = this._createActionByOption(\"onPageLoading\");\n  },\n  _scrollHandler: function _scrollHandler(e) {\n    this._scrollAction && this._scrollAction(e);\n  },\n  _initTemplates: function _initTemplates() {\n    this.callBase();\n    this._defaultTemplates.group = new BindableTemplate(function ($container, data) {\n      if (typeUtils.isPlainObject(data)) {\n        if (data.key) {\n          $container.text(data.key);\n        }\n      } else {\n        $container.text(String(data));\n      }\n    }, [\"key\"], this.option(\"integrationOptions.watchMethod\"));\n  },\n  _prepareDefaultItemTemplate: function _prepareDefaultItemTemplate(data, $container) {\n    this.callBase(data, $container);\n    if (data.icon) {\n      var $icon = iconUtils.getImageContainer(data.icon).addClass(LIST_ITEM_ICON_CLASS),\n        $iconContainer = $(\"<div>\").addClass(LIST_ITEM_ICON_CONTAINER_CLASS);\n      $iconContainer.append($icon);\n      $container.prepend($iconContainer);\n    }\n  },\n  _getBindableFields: function _getBindableFields() {\n    return [\"text\", \"html\", \"icon\"];\n  },\n  _updateLoadingState: function _updateLoadingState(tryLoadMore) {\n    var isDataLoaded = !tryLoadMore || this._isLastPage(),\n      scrollBottomMode = this._scrollBottomMode(),\n      stopLoading = isDataLoaded || !scrollBottomMode,\n      hideLoadIndicator = stopLoading && !this._isDataSourceLoading();\n    if (stopLoading || this._scrollViewIsFull()) {\n      this._scrollView.release(hideLoadIndicator);\n      this._toggleNextButton(this._shouldRenderNextButton() && !this._isLastPage());\n      this._loadIndicationSuppressed(false);\n    } else {\n      this._infiniteDataLoading();\n    }\n  },\n  _shouldRenderNextButton: function _shouldRenderNextButton() {\n    return this._nextButtonMode() && this._dataSource && this._dataSource.isLoaded();\n  },\n  _dataSourceLoadingChangedHandler: function _dataSourceLoadingChangedHandler(isLoading) {\n    if (this._loadIndicationSuppressed()) {\n      return;\n    }\n    if (isLoading && this.option(\"indicateLoading\")) {\n      this._showLoadingIndicatorTimer = setTimeout(function () {\n        var isEmpty = !this._itemElements().length;\n        if (this._scrollView && !isEmpty) {\n          this._scrollView.startLoading();\n        }\n      }.bind(this));\n    } else {\n      clearTimeout(this._showLoadingIndicatorTimer);\n      this._scrollView && this._scrollView.finishLoading();\n    }\n  },\n  _dataSourceChangedHandler: function _dataSourceChangedHandler(newItems) {\n    if (!this._shouldAppendItems() && windowUtils.hasWindow()) {\n      this._scrollView && this._scrollView.scrollTo(0);\n    }\n    this.callBase.apply(this, arguments);\n  },\n  _refreshContent: function _refreshContent() {\n    this._prepareContent();\n    this._fireContentReadyAction();\n  },\n  _hideLoadingIfLoadIndicationOff: function _hideLoadingIfLoadIndicationOff() {\n    if (!this.option(\"indicateLoading\")) {\n      this._dataSourceLoadingChangedHandler(false);\n    }\n  },\n  _loadIndicationSuppressed: function _loadIndicationSuppressed(value) {\n    if (!arguments.length) {\n      return this._isLoadIndicationSuppressed;\n    }\n    this._isLoadIndicationSuppressed = value;\n  },\n  _scrollViewIsFull: function _scrollViewIsFull() {\n    return !this._scrollView || this._scrollView.isFull();\n  },\n  _pullDownHandler: function _pullDownHandler(e) {\n    this._pullRefreshAction(e);\n    if (this._dataSource && !this._isDataSourceLoading()) {\n      this._clearSelectedItems();\n      this._dataSource.pageIndex(0);\n      this._dataSource.reload();\n    } else {\n      this._updateLoadingState();\n    }\n  },\n  _infiniteDataLoading: function _infiniteDataLoading() {\n    var isElementVisible = this.$element().is(\":visible\");\n    if (isElementVisible && !this._scrollViewIsFull() && !this._isDataSourceLoading() && !this._isLastPage()) {\n      clearTimeout(this._loadNextPageTimer);\n      this._loadNextPageTimer = setTimeout(this._loadNextPage.bind(this));\n    }\n  },\n  _scrollBottomHandler: function _scrollBottomHandler(e) {\n    this._pageLoadingAction(e);\n    if (!this._isDataSourceLoading() && !this._isLastPage()) {\n      this._loadNextPage();\n    } else {\n      this._updateLoadingState();\n    }\n  },\n  _renderItems: function _renderItems(items) {\n    if (this.option(\"grouped\")) {\n      each(items, this._renderGroup.bind(this));\n      this._attachGroupCollapseEvent();\n      this._renderEmptyMessage();\n      if (themes.isMaterial()) {\n        this.attachGroupHeaderInkRippleEvents();\n      }\n    } else {\n      this.callBase.apply(this, arguments);\n    }\n    this._refreshItemElements();\n    this._updateLoadingState(true);\n  },\n  _attachGroupCollapseEvent: function _attachGroupCollapseEvent() {\n    var eventName = eventUtils.addNamespace(clickEvent.name, this.NAME),\n      selector = \".\" + LIST_GROUP_HEADER_CLASS,\n      $element = this.$element(),\n      collapsibleGroups = this.option(\"collapsibleGroups\");\n    $element.toggleClass(LIST_COLLAPSIBLE_GROUPS_CLASS, collapsibleGroups);\n    eventsEngine.off($element, eventName, selector);\n    if (collapsibleGroups) {\n      eventsEngine.on($element, eventName, selector, function (e) {\n        this._createAction(function (e) {\n          var $group = $(e.event.currentTarget).parent();\n          this._collapseGroupHandler($group);\n          if (this.option(\"focusStateEnabled\")) {\n            this.option(\"focusedElement\", getPublicElement($group.find(\".\" + LIST_ITEM_CLASS).eq(0)));\n          }\n        }.bind(this), {\n          validatingTargetName: \"element\"\n        })({\n          event: e\n        });\n      }.bind(this));\n    }\n  },\n  _collapseGroupHandler: function _collapseGroupHandler($group, toggle) {\n    var deferred = new Deferred();\n    if ($group.hasClass(LIST_GROUP_COLLAPSED_CLASS) === toggle) {\n      return deferred.resolve();\n    }\n    var $groupBody = $group.children(\".\" + LIST_GROUP_BODY_CLASS);\n    var startHeight = $groupBody.outerHeight();\n    var endHeight = 0 === startHeight ? $groupBody.height(\"auto\").outerHeight() : 0;\n    $group.toggleClass(LIST_GROUP_COLLAPSED_CLASS, toggle);\n    fx.animate($groupBody, {\n      type: \"custom\",\n      from: {\n        height: startHeight\n      },\n      to: {\n        height: endHeight\n      },\n      duration: 200,\n      complete: function () {\n        this.updateDimensions();\n        this._updateLoadingState();\n        deferred.resolve();\n      }.bind(this)\n    });\n    return deferred.promise();\n  },\n  _dataSourceLoadErrorHandler: function _dataSourceLoadErrorHandler() {\n    this._forgetNextPageLoading();\n    if (this._initialized) {\n      this._renderEmptyMessage();\n      this._updateLoadingState();\n    }\n  },\n  _initMarkup: function _initMarkup() {\n    this._itemElementsCache = $();\n    this.$element().addClass(LIST_CLASS);\n    this.callBase();\n    this.option(\"useInkRipple\") && this._renderInkRipple();\n    this.setAria(\"role\", this.option(\"_listAttributes\").role);\n  },\n  _renderInkRipple: function _renderInkRipple() {\n    this._inkRipple = inkRipple.render();\n  },\n  _toggleActiveState: function _toggleActiveState($element, value, e) {\n    this.callBase.apply(this, arguments);\n    var that = this;\n    if (!this._inkRipple) {\n      return;\n    }\n    var config = {\n      element: $element,\n      event: e\n    };\n    if (value) {\n      if (themes.isMaterial()) {\n        this._inkRippleTimer = setTimeout(function () {\n          that._inkRipple.showWave(config);\n        }, LIST_FEEDBACK_SHOW_TIMEOUT / 2);\n      } else {\n        that._inkRipple.showWave(config);\n      }\n    } else {\n      clearTimeout(this._inkRippleTimer);\n      this._inkRipple.hideWave(config);\n    }\n  },\n  _postprocessRenderItem: function _postprocessRenderItem(args) {\n    this._refreshItemElements();\n    this.callBase.apply(this, arguments);\n    if (this.option(\"onItemSwipe\")) {\n      this._attachSwipeEvent($(args.itemElement));\n    }\n  },\n  _attachSwipeEvent: function _attachSwipeEvent($itemElement) {\n    var endEventName = eventUtils.addNamespace(swipeEvents.end, this.NAME);\n    eventsEngine.on($itemElement, endEventName, this._itemSwipeEndHandler.bind(this));\n  },\n  _itemSwipeEndHandler: function _itemSwipeEndHandler(e) {\n    this._itemDXEventHandler(e, \"onItemSwipe\", {\n      direction: e.offset < 0 ? \"left\" : \"right\"\n    });\n  },\n  _nextButtonHandler: function _nextButtonHandler() {\n    var source = this._dataSource;\n    if (source && !source.isLoading()) {\n      this._scrollView.toggleLoading(true);\n      this._$nextButton.detach();\n      this._loadIndicationSuppressed(true);\n      this._loadNextPage();\n    }\n  },\n  _renderGroup: function _renderGroup(index, group) {\n    var $groupElement = $(\"<div>\").addClass(LIST_GROUP_CLASS).appendTo(this._itemContainer());\n    var $groupHeaderElement = $(\"<div>\").addClass(LIST_GROUP_HEADER_CLASS).appendTo($groupElement);\n    var groupTemplateName = this.option(\"groupTemplate\"),\n      groupTemplate = this._getTemplate(group.template || groupTemplateName, group, index, $groupHeaderElement),\n      renderArgs = {\n        index: index,\n        itemData: group,\n        container: getPublicElement($groupHeaderElement)\n      };\n    this._createItemByTemplate(groupTemplate, renderArgs);\n    if (themes.isMaterial()) {\n      $(\"<div>\").addClass(LIST_GROUP_HEADER_INDICATOR_CLASS).prependTo($groupHeaderElement);\n    }\n    this._renderingGroupIndex = index;\n    var $groupBody = $(\"<div>\").addClass(LIST_GROUP_BODY_CLASS).appendTo($groupElement);\n    each(groupItemsGetter(group) || [], function (index, item) {\n      this._renderItem(index, item, $groupBody);\n    }.bind(this));\n    this._groupRenderAction({\n      groupElement: getPublicElement($groupElement),\n      groupIndex: index,\n      groupData: group\n    });\n  },\n  attachGroupHeaderInkRippleEvents: function attachGroupHeaderInkRippleEvents() {\n    var that = this,\n      selector = \".\" + LIST_GROUP_HEADER_CLASS,\n      $element = this.$element();\n    eventsEngine.on($element, \"dxpointerdown\", selector, function (e) {\n      that._toggleActiveState($(e.currentTarget), true, e);\n    });\n    eventsEngine.on($element, \"dxpointerup dxhoverend\", selector, function (e) {\n      that._toggleActiveState($(e.currentTarget), false);\n    });\n  },\n  _createGroupRenderAction: function _createGroupRenderAction() {\n    this._groupRenderAction = this._createActionByOption(\"onGroupRendered\");\n  },\n  _clean: function _clean() {\n    clearTimeout(this._inkRippleTimer);\n    if (this._$nextButton) {\n      this._$nextButton.remove();\n      this._$nextButton = null;\n    }\n    this.callBase.apply(this, arguments);\n  },\n  _dispose: function _dispose() {\n    clearTimeout(this._holdTimer);\n    clearTimeout(this._loadNextPageTimer);\n    clearTimeout(this._showLoadingIndicatorTimer);\n    this.callBase();\n  },\n  _toggleDisabledState: function _toggleDisabledState(value) {\n    this.callBase(value);\n    this._scrollView.option(\"disabled\", value || !this.option(\"scrollingEnabled\"));\n  },\n  _toggleNextButton: function _toggleNextButton(value) {\n    var dataSource = this._dataSource,\n      $nextButton = this._getNextButton();\n    this.$element().toggleClass(LIST_HAS_NEXT_CLASS, value);\n    if (value && dataSource && dataSource.isLoaded()) {\n      $nextButton.appendTo(this._itemContainer());\n    }\n    if (!value) {\n      $nextButton.detach();\n    }\n  },\n  _getNextButton: function _getNextButton() {\n    if (!this._$nextButton) {\n      this._$nextButton = this._createNextButton();\n    }\n    return this._$nextButton;\n  },\n  _createNextButton: function _createNextButton() {\n    var $result = $(\"<div>\").addClass(LIST_NEXT_BUTTON_CLASS);\n    var $button = $(\"<div>\").appendTo($result);\n    this._createComponent($button, Button, {\n      text: this.option(\"nextButtonText\"),\n      onClick: this._nextButtonHandler.bind(this),\n      type: themes.isMaterial() ? \"default\" : void 0,\n      integrationOptions: {}\n    });\n    return $result;\n  },\n  _moveFocus: function _moveFocus() {\n    this.callBase.apply(this, arguments);\n    this.scrollToItem(this.option(\"focusedElement\"));\n  },\n  _refresh: function _refresh() {\n    if (!windowUtils.hasWindow()) {\n      this.callBase();\n    } else {\n      var scrollTop = this._scrollView.scrollTop();\n      this.callBase();\n      scrollTop && this._scrollView.scrollTo(scrollTop);\n    }\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"pageLoadMode\":\n        this._toggleNextButton(args.value);\n        this._initScrollView();\n        break;\n      case \"dataSource\":\n        this.callBase(args);\n        this._initScrollView();\n        break;\n      case \"pullingDownText\":\n      case \"pulledDownText\":\n      case \"refreshingText\":\n      case \"pageLoadingText\":\n      case \"useNative\":\n      case \"showScrollbar\":\n      case \"bounceEnabled\":\n      case \"scrollByContent\":\n      case \"scrollByThumb\":\n      case \"scrollingEnabled\":\n      case \"pullRefreshEnabled\":\n        this._initScrollView();\n        this._updateLoadingState();\n        break;\n      case \"nextButtonText\":\n      case \"onItemSwipe\":\n      case \"useInkRipple\":\n        this._invalidate();\n        break;\n      case \"onScroll\":\n      case \"onPullRefresh\":\n      case \"onPageLoading\":\n        this._createScrollViewActions();\n        this._invalidate();\n        break;\n      case \"grouped\":\n      case \"collapsibleGroups\":\n      case \"groupTemplate\":\n        this._invalidate();\n        break;\n      case \"wrapItemText\":\n        this._$container.toggleClass(WRAP_ITEM_TEXT_CLASS, args.value);\n        break;\n      case \"onGroupRendered\":\n        this._createGroupRenderAction();\n        break;\n      case \"width\":\n      case \"height\":\n        this.callBase(args);\n        this._scrollView.update();\n        break;\n      case \"indicateLoading\":\n        this._hideLoadingIfLoadIndicationOff();\n        break;\n      case \"visible\":\n        this.callBase(args);\n        this._scrollView.update();\n        break;\n      case \"rtlEnabled\":\n        this._initScrollView();\n        this.callBase(args);\n        break;\n      case \"showChevronExpr\":\n      case \"badgeExpr\":\n        this._invalidate();\n        break;\n      case \"_listAttributes\":\n        break;\n      default:\n        this.callBase(args);\n    }\n  },\n  _extendActionArgs: function _extendActionArgs($itemElement) {\n    if (!this.option(\"grouped\")) {\n      return this.callBase($itemElement);\n    }\n    var $group = $itemElement.closest(\".\" + LIST_GROUP_CLASS);\n    var $item = $group.find(\".\" + LIST_ITEM_CLASS);\n    return extend(this.callBase($itemElement), {\n      itemIndex: {\n        group: $group.index(),\n        item: $item.index($itemElement)\n      }\n    });\n  },\n  expandGroup: function expandGroup(groupIndex) {\n    var deferred = new Deferred(),\n      $group = this._itemContainer().find(\".\" + LIST_GROUP_CLASS).eq(groupIndex);\n    this._collapseGroupHandler($group, false).done(function () {\n      deferred.resolveWith(this);\n    }.bind(this));\n    return deferred.promise();\n  },\n  collapseGroup: function collapseGroup(groupIndex) {\n    var deferred = new Deferred(),\n      $group = this._itemContainer().find(\".\" + LIST_GROUP_CLASS).eq(groupIndex);\n    this._collapseGroupHandler($group, true).done(function () {\n      deferred.resolveWith(this);\n    }.bind(this));\n    return deferred;\n  },\n  updateDimensions: function updateDimensions() {\n    var that = this,\n      deferred = new Deferred();\n    if (that._scrollView) {\n      that._scrollView.update().done(function () {\n        !that._scrollViewIsFull() && that._updateLoadingState(true);\n        deferred.resolveWith(that);\n      });\n    } else {\n      deferred.resolveWith(that);\n    }\n    return deferred.promise();\n  },\n  reload: function reload() {\n    this.callBase();\n    this.scrollTo(0);\n    this._pullDownHandler();\n  },\n  repaint: function repaint() {\n    this.scrollTo(0);\n    this.callBase();\n  },\n  scrollTop: function scrollTop() {\n    return this._scrollView.scrollOffset().top;\n  },\n  clientHeight: function clientHeight() {\n    return this._scrollView.clientHeight();\n  },\n  scrollHeight: function scrollHeight() {\n    return this._scrollView.scrollHeight();\n  },\n  scrollBy: function scrollBy(distance) {\n    this._scrollView.scrollBy(distance);\n  },\n  scrollTo: function scrollTo(location) {\n    this._scrollView.scrollTo(location);\n  },\n  scrollToItem: function scrollToItem(itemElement) {\n    var $item = this._editStrategy.getItemElement(itemElement);\n    this._scrollView.scrollToElement($item);\n  }\n}).include(DataConverterMixin);\nListBase.ItemClass = ListItem;\nmodule.exports = ListBase;","map":null,"metadata":{},"sourceType":"script"}